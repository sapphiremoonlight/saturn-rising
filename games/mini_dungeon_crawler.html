<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini Dungeon Crawler</title>
<style>
  body { display: flex; flex-direction: column; align-items: center; font-family: Arial, sans-serif; background: #222; color: #eee; }
  h1 { margin: 20px; }
  #game { display: grid; grid-template-columns: repeat(10, 40px); grid-template-rows: repeat(10, 40px); gap: 2px; margin-bottom: 20px; }
  .cell { width: 40px; height: 40px; background: #444; display: flex; justify-content: center; align-items: center; font-size: 24px; }
  .player { background: #2a9d8f; color: white; }
  .enemy { background: #e76f51; color: white; }
  .treasure { background: #f4a261; color: black; }
  #controls { margin-bottom: 10px; display: flex; gap: 10px; }
  .touch-btn { padding: 10px 20px; background: #555; color: #eee; border: none; cursor: pointer; font-size: 16px; }
  .touch-btn:active { background: #777; }
</style>
</head>
<body>

<h1>Mini Dungeon Crawler</h1>
<div id="controls">
  <label>Difficulty: </label>
  <select id="difficulty">
    <option value="easy">Easy</option>
    <option value="medium" selected>Medium</option>
    <option value="hard">Hard</option>
  </select>
</div>
<div id="game"></div>
<div id="status"></div>
<div id="touchControls">
  <button class="touch-btn" data-dir="up">‚Üë</button>
  <button class="touch-btn" data-dir="left">‚Üê</button>
  <button class="touch-btn" data-dir="down">‚Üì</button>
  <button class="touch-btn" data-dir="right">‚Üí</button>
</div>

<script>
const GRID_SIZE = 10;
let player = { x: 0, y: 0 };
let treasure = { x: 9, y: 9 };
let enemies = [];

const gameEl = document.getElementById('game');
const statusEl = document.getElementById('status');
const difficultySelect = document.getElementById('difficulty');

function initEnemies() {
  const difficulty = difficultySelect.value;
  let enemyCount;
  if(difficulty === 'easy') enemyCount = 2;
  else if(difficulty === 'medium') enemyCount = 4;
  else enemyCount = 6;
  enemies = [];
  while(enemies.length < enemyCount) {
    const e = { x: Math.floor(Math.random() * GRID_SIZE), y: Math.floor(Math.random() * GRID_SIZE) };
    if ((e.x !== player.x || e.y !== player.y) && (e.x !== treasure.x || e.y !== treasure.y)) enemies.push(e);
  }
}

function drawGrid() {
  gameEl.innerHTML = '';
  for (let y = 0; y < GRID_SIZE; y++) {
    for (let x = 0; x < GRID_SIZE; x++) {
      const cell = document.createElement('div');
      cell.classList.add('cell');
      if (player.x === x && player.y === y) cell.classList.add('player'), cell.textContent = '‚ò∫';
      else if (treasure.x === x && treasure.y === y) cell.classList.add('treasure'), cell.textContent = 'üí∞';
      else {
        const enemyHere = enemies.find(e => e.x === x && e.y === y);
        if (enemyHere) cell.classList.add('enemy'), cell.textContent = '‚ò†';
      }
      gameEl.appendChild(cell);
    }
  }
  checkStatus();
}

function movePlayer(dx, dy) {
  const newX = player.x + dx;
  const newY = player.y + dy;
  if (newX < 0 || newX >= GRID_SIZE || newY < 0 || newY >= GRID_SIZE) return;
  player.x = newX; player.y = newY;
  moveEnemies();
  drawGrid();
}

function moveEnemies() {
  const difficulty = difficultySelect.value;
  enemies.forEach(e => {
    const dx = Math.sign(player.x - e.x);
    const dy = Math.sign(player.y - e.y);
    let moveChance = 0.7;
    if(difficulty === 'easy') moveChance = 0.5;
    else if(difficulty === 'hard') moveChance = 0.9;
    if (Math.random() < moveChance) {
      if (Math.random() > 0.5) e.x += dx;
      else e.y += dy;
      e.x = Math.max(0, Math.min(GRID_SIZE-1, e.x));
      e.y = Math.max(0, Math.min(GRID_SIZE-1, e.y));
    }
  });
}

function checkStatus() {
  if (player.x === treasure.x && player.y === treasure.y) statusEl.textContent = 'You found the treasure! üéâ';
  else if (enemies.some(e => e.x === player.x && e.y === player.y)) statusEl.textContent = 'You were caught by an enemy! ‚ò†';
  else statusEl.textContent = 'Use arrow keys or touch buttons to move. Reach the treasure!';
}

document.addEventListener('keydown', e => {
  if (e.key === 'ArrowUp') movePlayer(0, -1);
  if (e.key === 'ArrowDown') movePlayer(0, 1);
  if (e.key === 'ArrowLeft') movePlayer(-1, 0);
  if (e.key === 'ArrowRight') movePlayer(1, 0);
});

// Touch controls
document.querySelectorAll('.touch-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const dir = btn.dataset.dir;
    if(dir === 'up') movePlayer(0,-1);
    if(dir === 'down') movePlayer(0,1);
    if(dir === 'left') movePlayer(-1,0);
    if(dir === 'right') movePlayer(1,0);
  });
});

difficultySelect.addEventListener('change', () => {
  player = { x: 0, y: 0 };
  treasure = { x: 9, y: 9 };
  initEnemies();
  drawGrid();
});

initEnemies();
drawGrid();
</script>

</body>
</html>
